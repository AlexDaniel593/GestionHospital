á$
SC:\Users\dalex\OneDrive\Documentos\Code\GestionHospital\CapaDatos\TratamientoDAL.cs
	namespace

 	
	CapaDatos


 
{ 
public 

class 
TratamientoDAL 
{ 
private 
readonly  
ApplicationDbContext -
_context. 6
;6 7
public 
TratamientoDAL 
(  
ApplicationDbContext 2
context3 :
): ;
{ 	
_context 
= 
context 
; 
} 	
public 
List 
< 
TratamientoViewCLS &
>& '
ListarTratamiento( 9
(9 :
): ;
{ 	
return 
_context 
. !
TratamientosResultado 1
.1 2
ToList2 8
(8 9
)9 :
;: ;
} 	
public 
List 
< $
TratamientoMedicoViewCLS ,
>, -$
ListarTratamientosMedico. F
(F G
intG J
idMedicoK S
)S T
{ 	
var 
tratamientos 
= 
_context '
.' (
TratamientosMedico( :
. 
Where 
( 
t 
=> 
t 
. 
idMedico &
==' )
idMedico* 2
)2 3
. 
ToList 
( 
) 
; 
return 
tratamientos 
;  
}   	
public!! 
void!! 
GuardarTratamiento!! &
(!!& '
TratamientoCLS!!' 5
tratamiento!!6 A
)!!A B
{"" 	
var## 
idTratamientoParam## "
=### $
new##% (
SqlParameter##) 5
(##5 6
$str##6 F
,##F G
tratamiento##H S
.##S T
idTratamiento##T a
)##a b
;##b c
var$$ 
idPacienteParam$$ 
=$$  !
new$$" %
SqlParameter$$& 2
($$2 3
$str$$3 @
,$$@ A
tratamiento$$B M
.$$M N

idPaciente$$N X
)$$X Y
;$$Y Z
var%% 
descripcionParam%%  
=%%! "
new%%# &
SqlParameter%%' 3
(%%3 4
$str%%4 B
,%%B C
tratamiento%%D O
.%%O P
descripcion%%P [
)%%[ \
;%%\ ]
var&& 

fechaParam&& 
=&& 
new&&  
SqlParameter&&! -
(&&- .
$str&&. 6
,&&6 7
tratamiento&&8 C
.&&C D
fecha&&D I
)&&I J
;&&J K
var'' 

costoParam'' 
='' 
new''  
SqlParameter''! -
(''- .
$str''. 6
,''6 7
tratamiento''8 C
.''C D
costo''D I
)''I J
;''J K
_context)) 
.)) 
Database)) 
.)) 
ExecuteSqlRaw)) +
())+ ,
$str	)), Ç
,
))Ç É
idTratamientoParam** "
,**" #
idPacienteParam**$ 3
,**3 4
descripcionParam**5 E
,**E F

fechaParam**G Q
,**Q R

costoParam**S ]
)**] ^
;**^ _
}++ 	
public-- 
TratamientoCLS-- 
?--  
RecuperarTratamiento-- 3
(--3 4
int--4 7
idTratamiento--8 E
)--E F
{.. 	
return// 
_context// 
.// 
TRATAMIENTOS// (
.00 

FromSqlRaw00 
(00 
$str00 I
,00I J
new00K N
SqlParameter00O [
(00[ \
$str00\ l
,00l m
idTratamiento00n {
)00{ |
)00| }
.11 
AsEnumerable11 
(11 
)11 
.22 
FirstOrDefault22 
(22  
)22  !
;22! "
}33 	
public55 
void55 
EliminarTratamiento55 '
(55' (
int55( +
idTratamiento55, 9
)559 :
{66 	
_context77 
.77 
Database77 
.77 
ExecuteSqlRaw77 +
(77+ ,
$str77, X
,77X Y
new77Z ]
SqlParameter77^ j
(77j k
$str77k {
,77{ |
idTratamiento	77} ä
)
77ä ã
)
77ã å
;
77å ç
}88 	
}99 
}:: •+
PC:\Users\dalex\OneDrive\Documentos\Code\GestionHospital\CapaDatos\PacienteDAL.cs
	namespace 	
	CapaDatos
 
{ 
public 

class 
PacienteDAL 
{ 
private		 
readonly		  
ApplicationDbContext		 -
_context		. 6
;		6 7
public 
PacienteDAL 
(  
ApplicationDbContext /
context0 7
)7 8
{ 	
_context 
= 
context 
; 
} 	
public 
List 
< 
PacienteCLS 
>  
ListarPaciente! /
(/ 0
)0 1
{ 	
return 
_context 
. 
	PACIENTES %
.% &

FromSqlRaw& 0
(0 1
$str1 J
)J K
.K L
ToListL R
(R S
)S T
;T U
} 	
public 
List 
< 
PacienteCLS 
>   
ListarTodosPacientes! 5
(5 6
)6 7
{ 	
return 
_context 
. 
	PACIENTES %
.% &

FromSqlRaw& 0
(0 1
$str1 O
)O P
.P Q
ToListQ W
(W X
)X Y
;Y Z
} 	
public 
List 
< 
PacienteCLS 
>  $
ListarPacientesAsignados! 9
(9 :
int: =
idDoctor> F
)F G
{ 	
return 
_context 
. 
	PACIENTES %
.% &

FromSqlRaw& 0
(0 1
$str1 ]
,] ^
new_ b
SqlParameterc o
(o p
$strp {
,{ |
idDoctor	} Ö
)
Ö Ü
)
Ü á
.
á à
ToList
à é
(
é è
)
è ê
;
ê ë
} 	
public 
void 
GuardarPaciente #
(# $
PacienteCLS$ /
paciente0 8
)8 9
{ 	
var   
idParam   
=   
new   
SqlParameter   *
(  * +
$str  + 8
,  8 9
paciente  : B
.  B C

idPaciente  C M
)  M N
;  N O
var!! 
nombreParam!! 
=!! 
new!! !
SqlParameter!!" .
(!!. /
$str!!/ 8
,!!8 9
paciente!!: B
.!!B C
nombre!!C I
)!!I J
;!!J K
var"" 
apellidoParam"" 
="" 
new""  #
SqlParameter""$ 0
(""0 1
$str""1 <
,""< =
paciente""> F
.""F G
apellido""G O
)""O P
;""P Q
var##  
fechaNacimientoParam## $
=##% &
new##' *
SqlParameter##+ 7
(##7 8
$str##8 J
,##J K
paciente##L T
.##T U
fechaNacimiento##U d
)##d e
;##e f
var$$ 
telefonoParam$$ 
=$$ 
new$$  #
SqlParameter$$$ 0
($$0 1
$str$$1 <
,$$< =
paciente$$> F
.$$F G
telefono$$G O
)$$O P
;$$P Q
var%% 

emailParam%% 
=%% 
new%%  
SqlParameter%%! -
(%%- .
$str%%. 6
,%%6 7
paciente%%8 @
.%%@ A
email%%A F
)%%F G
;%%G H
var&& 
direccionParam&& 
=&&  
new&&! $
SqlParameter&&% 1
(&&1 2
$str&&2 >
,&&> ?
paciente&&@ H
.&&H I
	direccion&&I R
)&&R S
;&&S T
_context(( 
.(( 
Database(( 
.(( 
ExecuteSqlRaw(( +
(((+ ,
$str	((, ñ
,
((ñ ó
idParam)) 
,)) 
nombreParam)) $
,))$ %
apellidoParam))& 3
,))3 4 
fechaNacimientoParam))5 I
,))I J
telefonoParam))K X
,))X Y

emailParam))Z d
,))d e
direccionParam))f t
)))t u
;))u v
}** 	
public,, 
PacienteCLS,, 
?,, 
RecuperarPaciente,, -
(,,- .
int,,. 1

idPaciente,,2 <
),,< =
{-- 	
return.. 
_context.. 
... 
	PACIENTES.. %
.// 

FromSqlRaw// 
(// 
$str// C
,//C D
new//E H
SqlParameter//I U
(//U V
$str//V c
,//c d

idPaciente//e o
)//o p
)//p q
.00 
AsEnumerable00 
(00 
)00 
.11 
FirstOrDefault11 
(11  
)11  !
;11! "
}22 	
public44 
void44 
EliminarPaciente44 $
(44$ %
int44% (

idPaciente44) 3
)443 4
{55 	
_context66 
.66 
Database66 
.66 
ExecuteSqlRaw66 +
(66+ ,
$str66, R
,66R S
new66T W
SqlParameter66X d
(66d e
$str66e r
,66r s

idPaciente66t ~
)66~ 
)	66 Ä
;
66Ä Å
}88 	
}99 
}:: ï»
lC:\Users\dalex\OneDrive\Documentos\Code\GestionHospital\CapaDatos\Migrations\20250302050504_InitialCreate.cs
	namespace 	
	CapaDatos
 
. 

Migrations 
{ 
public		 

partial		 
class		 
InitialCreate		 &
:		' (
	Migration		) 2
{

 
	protected 
override 
void 
Up  "
(" #
MigrationBuilder# 3
migrationBuilder4 D
)D E
{ 	
migrationBuilder 
. 
CreateTable (
(( )
name 
: 
$str #
,# $
columns 
: 
table 
=> !
new" %
{ 
Id 
= 
table 
. 
Column %
<% &
string& ,
>, -
(- .
type. 2
:2 3
$str4 C
,C D
nullableE M
:M N
falseO T
)T U
,U V
Name 
= 
table  
.  !
Column! '
<' (
string( .
>. /
(/ 0
type0 4
:4 5
$str6 E
,E F
	maxLengthG P
:P Q
$numR U
,U V
nullableW _
:_ `
truea e
)e f
,f g
NormalizedName "
=# $
table% *
.* +
Column+ 1
<1 2
string2 8
>8 9
(9 :
type: >
:> ?
$str@ O
,O P
	maxLengthQ Z
:Z [
$num\ _
,_ `
nullablea i
:i j
truek o
)o p
,p q
ConcurrencyStamp $
=% &
table' ,
., -
Column- 3
<3 4
string4 :
>: ;
(; <
type< @
:@ A
$strB Q
,Q R
nullableS [
:[ \
true] a
)a b
} 
, 
constraints 
: 
table "
=># %
{ 
table 
. 

PrimaryKey $
($ %
$str% 5
,5 6
x7 8
=>9 ;
x< =
.= >
Id> @
)@ A
;A B
} 
) 
; 
migrationBuilder 
. 
CreateTable (
(( )
name 
: 
$str #
,# $
columns 
: 
table 
=> !
new" %
{ 
Id   
=   
table   
.   
Column   %
<  % &
string  & ,
>  , -
(  - .
type  . 2
:  2 3
$str  4 C
,  C D
nullable  E M
:  M N
false  O T
)  T U
,  U V
UserName!! 
=!! 
table!! $
.!!$ %
Column!!% +
<!!+ ,
string!!, 2
>!!2 3
(!!3 4
type!!4 8
:!!8 9
$str!!: I
,!!I J
	maxLength!!K T
:!!T U
$num!!V Y
,!!Y Z
nullable!![ c
:!!c d
true!!e i
)!!i j
,!!j k
NormalizedUserName"" &
=""' (
table"") .
."". /
Column""/ 5
<""5 6
string""6 <
>""< =
(""= >
type""> B
:""B C
$str""D S
,""S T
	maxLength""U ^
:""^ _
$num""` c
,""c d
nullable""e m
:""m n
true""o s
)""s t
,""t u
Email## 
=## 
table## !
.##! "
Column##" (
<##( )
string##) /
>##/ 0
(##0 1
type##1 5
:##5 6
$str##7 F
,##F G
	maxLength##H Q
:##Q R
$num##S V
,##V W
nullable##X `
:##` a
true##b f
)##f g
,##g h
NormalizedEmail$$ #
=$$$ %
table$$& +
.$$+ ,
Column$$, 2
<$$2 3
string$$3 9
>$$9 :
($$: ;
type$$; ?
:$$? @
$str$$A P
,$$P Q
	maxLength$$R [
:$$[ \
$num$$] `
,$$` a
nullable$$b j
:$$j k
true$$l p
)$$p q
,$$q r
EmailConfirmed%% "
=%%# $
table%%% *
.%%* +
Column%%+ 1
<%%1 2
bool%%2 6
>%%6 7
(%%7 8
type%%8 <
:%%< =
$str%%> C
,%%C D
nullable%%E M
:%%M N
false%%O T
)%%T U
,%%U V
PasswordHash&&  
=&&! "
table&&# (
.&&( )
Column&&) /
<&&/ 0
string&&0 6
>&&6 7
(&&7 8
type&&8 <
:&&< =
$str&&> M
,&&M N
nullable&&O W
:&&W X
true&&Y ]
)&&] ^
,&&^ _
SecurityStamp'' !
=''" #
table''$ )
.'') *
Column''* 0
<''0 1
string''1 7
>''7 8
(''8 9
type''9 =
:''= >
$str''? N
,''N O
nullable''P X
:''X Y
true''Z ^
)''^ _
,''_ `
ConcurrencyStamp(( $
=((% &
table((' ,
.((, -
Column((- 3
<((3 4
string((4 :
>((: ;
(((; <
type((< @
:((@ A
$str((B Q
,((Q R
nullable((S [
:(([ \
true((] a
)((a b
,((b c
PhoneNumber)) 
=))  !
table))" '
.))' (
Column))( .
<)). /
string))/ 5
>))5 6
())6 7
type))7 ;
:)); <
$str))= L
,))L M
nullable))N V
:))V W
true))X \
)))\ ]
,))] ^ 
PhoneNumberConfirmed** (
=**) *
table**+ 0
.**0 1
Column**1 7
<**7 8
bool**8 <
>**< =
(**= >
type**> B
:**B C
$str**D I
,**I J
nullable**K S
:**S T
false**U Z
)**Z [
,**[ \
TwoFactorEnabled++ $
=++% &
table++' ,
.++, -
Column++- 3
<++3 4
bool++4 8
>++8 9
(++9 :
type++: >
:++> ?
$str++@ E
,++E F
nullable++G O
:++O P
false++Q V
)++V W
,++W X

LockoutEnd,, 
=,,  
table,,! &
.,,& '
Column,,' -
<,,- .
DateTimeOffset,,. <
>,,< =
(,,= >
type,,> B
:,,B C
$str,,D T
,,,T U
nullable,,V ^
:,,^ _
true,,` d
),,d e
,,,e f
LockoutEnabled-- "
=--# $
table--% *
.--* +
Column--+ 1
<--1 2
bool--2 6
>--6 7
(--7 8
type--8 <
:--< =
$str--> C
,--C D
nullable--E M
:--M N
false--O T
)--T U
,--U V
AccessFailedCount.. %
=..& '
table..( -
...- .
Column... 4
<..4 5
int..5 8
>..8 9
(..9 :
type..: >
:..> ?
$str..@ E
,..E F
nullable..G O
:..O P
false..Q V
)..V W
}// 
,// 
constraints00 
:00 
table00 "
=>00# %
{11 
table22 
.22 

PrimaryKey22 $
(22$ %
$str22% 5
,225 6
x227 8
=>229 ;
x22< =
.22= >
Id22> @
)22@ A
;22A B
}33 
)33 
;33 
migrationBuilder55 
.55 
CreateTable55 (
(55( )
name66 
:66 
$str66 (
,66( )
columns77 
:77 
table77 
=>77 !
new77" %
{88 
Id99 
=99 
table99 
.99 
Column99 %
<99% &
int99& )
>99) *
(99* +
type99+ /
:99/ 0
$str991 6
,996 7
nullable998 @
:99@ A
false99B G
)99G H
.:: 

Annotation:: #
(::# $
$str::$ 8
,::8 9
$str::: @
)::@ A
,::A B
RoleId;; 
=;; 
table;; "
.;;" #
Column;;# )
<;;) *
string;;* 0
>;;0 1
(;;1 2
type;;2 6
:;;6 7
$str;;8 G
,;;G H
nullable;;I Q
:;;Q R
false;;S X
);;X Y
,;;Y Z
	ClaimType<< 
=<< 
table<<  %
.<<% &
Column<<& ,
<<<, -
string<<- 3
><<3 4
(<<4 5
type<<5 9
:<<9 :
$str<<; J
,<<J K
nullable<<L T
:<<T U
true<<V Z
)<<Z [
,<<[ \

ClaimValue== 
===  
table==! &
.==& '
Column==' -
<==- .
string==. 4
>==4 5
(==5 6
type==6 :
:==: ;
$str==< K
,==K L
nullable==M U
:==U V
true==W [
)==[ \
}>> 
,>> 
constraints?? 
:?? 
table?? "
=>??# %
{@@ 
tableAA 
.AA 

PrimaryKeyAA $
(AA$ %
$strAA% :
,AA: ;
xAA< =
=>AA> @
xAAA B
.AAB C
IdAAC E
)AAE F
;AAF G
tableBB 
.BB 

ForeignKeyBB $
(BB$ %
nameCC 
:CC 
$strCC F
,CCF G
columnDD 
:DD 
xDD  !
=>DD" $
xDD% &
.DD& '
RoleIdDD' -
,DD- .
principalTableEE &
:EE& '
$strEE( 5
,EE5 6
principalColumnFF '
:FF' (
$strFF) -
,FF- .
onDeleteGG  
:GG  !
ReferentialActionGG" 3
.GG3 4
CascadeGG4 ;
)GG; <
;GG< =
}HH 
)HH 
;HH 
migrationBuilderJJ 
.JJ 
CreateTableJJ (
(JJ( )
nameKK 
:KK 
$strKK (
,KK( )
columnsLL 
:LL 
tableLL 
=>LL !
newLL" %
{MM 
IdNN 
=NN 
tableNN 
.NN 
ColumnNN %
<NN% &
intNN& )
>NN) *
(NN* +
typeNN+ /
:NN/ 0
$strNN1 6
,NN6 7
nullableNN8 @
:NN@ A
falseNNB G
)NNG H
.OO 

AnnotationOO #
(OO# $
$strOO$ 8
,OO8 9
$strOO: @
)OO@ A
,OOA B
UserIdPP 
=PP 
tablePP "
.PP" #
ColumnPP# )
<PP) *
stringPP* 0
>PP0 1
(PP1 2
typePP2 6
:PP6 7
$strPP8 G
,PPG H
nullablePPI Q
:PPQ R
falsePPS X
)PPX Y
,PPY Z
	ClaimTypeQQ 
=QQ 
tableQQ  %
.QQ% &
ColumnQQ& ,
<QQ, -
stringQQ- 3
>QQ3 4
(QQ4 5
typeQQ5 9
:QQ9 :
$strQQ; J
,QQJ K
nullableQQL T
:QQT U
trueQQV Z
)QQZ [
,QQ[ \

ClaimValueRR 
=RR  
tableRR! &
.RR& '
ColumnRR' -
<RR- .
stringRR. 4
>RR4 5
(RR5 6
typeRR6 :
:RR: ;
$strRR< K
,RRK L
nullableRRM U
:RRU V
trueRRW [
)RR[ \
}SS 
,SS 
constraintsTT 
:TT 
tableTT "
=>TT# %
{UU 
tableVV 
.VV 

PrimaryKeyVV $
(VV$ %
$strVV% :
,VV: ;
xVV< =
=>VV> @
xVVA B
.VVB C
IdVVC E
)VVE F
;VVF G
tableWW 
.WW 

ForeignKeyWW $
(WW$ %
nameXX 
:XX 
$strXX F
,XXF G
columnYY 
:YY 
xYY  !
=>YY" $
xYY% &
.YY& '
UserIdYY' -
,YY- .
principalTableZZ &
:ZZ& '
$strZZ( 5
,ZZ5 6
principalColumn[[ '
:[[' (
$str[[) -
,[[- .
onDelete\\  
:\\  !
ReferentialAction\\" 3
.\\3 4
Cascade\\4 ;
)\\; <
;\\< =
}]] 
)]] 
;]] 
migrationBuilder__ 
.__ 
CreateTable__ (
(__( )
name`` 
:`` 
$str`` (
,``( )
columnsaa 
:aa 
tableaa 
=>aa !
newaa" %
{bb 
LoginProvidercc !
=cc" #
tablecc$ )
.cc) *
Columncc* 0
<cc0 1
stringcc1 7
>cc7 8
(cc8 9
typecc9 =
:cc= >
$strcc? N
,ccN O
	maxLengthccP Y
:ccY Z
$numcc[ ^
,cc^ _
nullablecc` h
:cch i
falseccj o
)cco p
,ccp q
ProviderKeydd 
=dd  !
tabledd" '
.dd' (
Columndd( .
<dd. /
stringdd/ 5
>dd5 6
(dd6 7
typedd7 ;
:dd; <
$strdd= L
,ddL M
	maxLengthddN W
:ddW X
$numddY \
,dd\ ]
nullabledd^ f
:ddf g
falseddh m
)ddm n
,ddn o
ProviderDisplayNameee '
=ee( )
tableee* /
.ee/ 0
Columnee0 6
<ee6 7
stringee7 =
>ee= >
(ee> ?
typeee? C
:eeC D
$streeE T
,eeT U
nullableeeV ^
:ee^ _
trueee` d
)eed e
,eee f
UserIdff 
=ff 
tableff "
.ff" #
Columnff# )
<ff) *
stringff* 0
>ff0 1
(ff1 2
typeff2 6
:ff6 7
$strff8 G
,ffG H
nullableffI Q
:ffQ R
falseffS X
)ffX Y
}gg 
,gg 
constraintshh 
:hh 
tablehh "
=>hh# %
{ii 
tablejj 
.jj 

PrimaryKeyjj $
(jj$ %
$strjj% :
,jj: ;
xjj< =
=>jj> @
newjjA D
{jjE F
xjjG H
.jjH I
LoginProviderjjI V
,jjV W
xjjX Y
.jjY Z
ProviderKeyjjZ e
}jjf g
)jjg h
;jjh i
tablekk 
.kk 

ForeignKeykk $
(kk$ %
namell 
:ll 
$strll F
,llF G
columnmm 
:mm 
xmm  !
=>mm" $
xmm% &
.mm& '
UserIdmm' -
,mm- .
principalTablenn &
:nn& '
$strnn( 5
,nn5 6
principalColumnoo '
:oo' (
$stroo) -
,oo- .
onDeletepp  
:pp  !
ReferentialActionpp" 3
.pp3 4
Cascadepp4 ;
)pp; <
;pp< =
}qq 
)qq 
;qq 
migrationBuilderss 
.ss 
CreateTabless (
(ss( )
namett 
:tt 
$strtt '
,tt' (
columnsuu 
:uu 
tableuu 
=>uu !
newuu" %
{vv 
UserIdww 
=ww 
tableww "
.ww" #
Columnww# )
<ww) *
stringww* 0
>ww0 1
(ww1 2
typeww2 6
:ww6 7
$strww8 G
,wwG H
nullablewwI Q
:wwQ R
falsewwS X
)wwX Y
,wwY Z
RoleIdxx 
=xx 
tablexx "
.xx" #
Columnxx# )
<xx) *
stringxx* 0
>xx0 1
(xx1 2
typexx2 6
:xx6 7
$strxx8 G
,xxG H
nullablexxI Q
:xxQ R
falsexxS X
)xxX Y
}yy 
,yy 
constraintszz 
:zz 
tablezz "
=>zz# %
{{{ 
table|| 
.|| 

PrimaryKey|| $
(||$ %
$str||% 9
,||9 :
x||; <
=>||= ?
new||@ C
{||D E
x||F G
.||G H
UserId||H N
,||N O
x||P Q
.||Q R
RoleId||R X
}||Y Z
)||Z [
;||[ \
table}} 
.}} 

ForeignKey}} $
(}}$ %
name~~ 
:~~ 
$str~~ E
,~~E F
column 
: 
x  !
=>" $
x% &
.& '
RoleId' -
,- .
principalTable
ÄÄ &
:
ÄÄ& '
$str
ÄÄ( 5
,
ÄÄ5 6
principalColumn
ÅÅ '
:
ÅÅ' (
$str
ÅÅ) -
,
ÅÅ- .
onDelete
ÇÇ  
:
ÇÇ  !
ReferentialAction
ÇÇ" 3
.
ÇÇ3 4
Cascade
ÇÇ4 ;
)
ÇÇ; <
;
ÇÇ< =
table
ÉÉ 
.
ÉÉ 

ForeignKey
ÉÉ $
(
ÉÉ$ %
name
ÑÑ 
:
ÑÑ 
$str
ÑÑ E
,
ÑÑE F
column
ÖÖ 
:
ÖÖ 
x
ÖÖ  !
=>
ÖÖ" $
x
ÖÖ% &
.
ÖÖ& '
UserId
ÖÖ' -
,
ÖÖ- .
principalTable
ÜÜ &
:
ÜÜ& '
$str
ÜÜ( 5
,
ÜÜ5 6
principalColumn
áá '
:
áá' (
$str
áá) -
,
áá- .
onDelete
àà  
:
àà  !
ReferentialAction
àà" 3
.
àà3 4
Cascade
àà4 ;
)
àà; <
;
àà< =
}
ââ 
)
ââ 
;
ââ 
migrationBuilder
ãã 
.
ãã 
CreateTable
ãã (
(
ãã( )
name
åå 
:
åå 
$str
åå (
,
åå( )
columns
çç 
:
çç 
table
çç 
=>
çç !
new
çç" %
{
éé 
UserId
èè 
=
èè 
table
èè "
.
èè" #
Column
èè# )
<
èè) *
string
èè* 0
>
èè0 1
(
èè1 2
type
èè2 6
:
èè6 7
$str
èè8 G
,
èèG H
nullable
èèI Q
:
èèQ R
false
èèS X
)
èèX Y
,
èèY Z
LoginProvider
êê !
=
êê" #
table
êê$ )
.
êê) *
Column
êê* 0
<
êê0 1
string
êê1 7
>
êê7 8
(
êê8 9
type
êê9 =
:
êê= >
$str
êê? N
,
êêN O
	maxLength
êêP Y
:
êêY Z
$num
êê[ ^
,
êê^ _
nullable
êê` h
:
êêh i
false
êêj o
)
êêo p
,
êêp q
Name
ëë 
=
ëë 
table
ëë  
.
ëë  !
Column
ëë! '
<
ëë' (
string
ëë( .
>
ëë. /
(
ëë/ 0
type
ëë0 4
:
ëë4 5
$str
ëë6 E
,
ëëE F
	maxLength
ëëG P
:
ëëP Q
$num
ëëR U
,
ëëU V
nullable
ëëW _
:
ëë_ `
false
ëëa f
)
ëëf g
,
ëëg h
Value
íí 
=
íí 
table
íí !
.
íí! "
Column
íí" (
<
íí( )
string
íí) /
>
íí/ 0
(
íí0 1
type
íí1 5
:
íí5 6
$str
íí7 F
,
ííF G
nullable
ííH P
:
ííP Q
true
ííR V
)
ííV W
}
ìì 
,
ìì 
constraints
îî 
:
îî 
table
îî "
=>
îî# %
{
ïï 
table
ññ 
.
ññ 

PrimaryKey
ññ $
(
ññ$ %
$str
ññ% :
,
ññ: ;
x
ññ< =
=>
ññ> @
new
ññA D
{
ññE F
x
ññG H
.
ññH I
UserId
ññI O
,
ññO P
x
ññQ R
.
ññR S
LoginProvider
ññS `
,
ññ` a
x
ññb c
.
ññc d
Name
ññd h
}
ññi j
)
ññj k
;
ññk l
table
óó 
.
óó 

ForeignKey
óó $
(
óó$ %
name
òò 
:
òò 
$str
òò F
,
òòF G
column
ôô 
:
ôô 
x
ôô  !
=>
ôô" $
x
ôô% &
.
ôô& '
UserId
ôô' -
,
ôô- .
principalTable
öö &
:
öö& '
$str
öö( 5
,
öö5 6
principalColumn
õõ '
:
õõ' (
$str
õõ) -
,
õõ- .
onDelete
úú  
:
úú  !
ReferentialAction
úú" 3
.
úú3 4
Cascade
úú4 ;
)
úú; <
;
úú< =
}
ùù 
)
ùù 
;
ùù 
migrationBuilder
üü 
.
üü 
CreateIndex
üü (
(
üü( )
name
†† 
:
†† 
$str
†† 2
,
††2 3
table
°° 
:
°° 
$str
°° )
,
°°) *
column
¢¢ 
:
¢¢ 
$str
¢¢  
)
¢¢  !
;
¢¢! "
migrationBuilder
§§ 
.
§§ 
CreateIndex
§§ (
(
§§( )
name
•• 
:
•• 
$str
•• %
,
••% &
table
¶¶ 
:
¶¶ 
$str
¶¶ $
,
¶¶$ %
column
ßß 
:
ßß 
$str
ßß (
,
ßß( )
unique
®® 
:
®® 
true
®® 
,
®® 
filter
©© 
:
©© 
$str
©© 6
)
©©6 7
;
©©7 8
migrationBuilder
´´ 
.
´´ 
CreateIndex
´´ (
(
´´( )
name
¨¨ 
:
¨¨ 
$str
¨¨ 2
,
¨¨2 3
table
≠≠ 
:
≠≠ 
$str
≠≠ )
,
≠≠) *
column
ÆÆ 
:
ÆÆ 
$str
ÆÆ  
)
ÆÆ  !
;
ÆÆ! "
migrationBuilder
∞∞ 
.
∞∞ 
CreateIndex
∞∞ (
(
∞∞( )
name
±± 
:
±± 
$str
±± 2
,
±±2 3
table
≤≤ 
:
≤≤ 
$str
≤≤ )
,
≤≤) *
column
≥≥ 
:
≥≥ 
$str
≥≥  
)
≥≥  !
;
≥≥! "
migrationBuilder
µµ 
.
µµ 
CreateIndex
µµ (
(
µµ( )
name
∂∂ 
:
∂∂ 
$str
∂∂ 1
,
∂∂1 2
table
∑∑ 
:
∑∑ 
$str
∑∑ (
,
∑∑( )
column
∏∏ 
:
∏∏ 
$str
∏∏  
)
∏∏  !
;
∏∏! "
migrationBuilder
∫∫ 
.
∫∫ 
CreateIndex
∫∫ (
(
∫∫( )
name
ªª 
:
ªª 
$str
ªª "
,
ªª" #
table
ºº 
:
ºº 
$str
ºº $
,
ºº$ %
column
ΩΩ 
:
ΩΩ 
$str
ΩΩ )
)
ΩΩ) *
;
ΩΩ* +
migrationBuilder
øø 
.
øø 
CreateIndex
øø (
(
øø( )
name
¿¿ 
:
¿¿ 
$str
¿¿ %
,
¿¿% &
table
¡¡ 
:
¡¡ 
$str
¡¡ $
,
¡¡$ %
column
¬¬ 
:
¬¬ 
$str
¬¬ ,
,
¬¬, -
unique
√√ 
:
√√ 
true
√√ 
,
√√ 
filter
ƒƒ 
:
ƒƒ 
$str
ƒƒ :
)
ƒƒ: ;
;
ƒƒ; <
}
≈≈ 	
	protected
»» 
override
»» 
void
»» 
Down
»»  $
(
»»$ %
MigrationBuilder
»»% 5
migrationBuilder
»»6 F
)
»»F G
{
…… 	
migrationBuilder
   
.
   
	DropTable
   &
(
  & '
name
ÀÀ 
:
ÀÀ 
$str
ÀÀ (
)
ÀÀ( )
;
ÀÀ) *
migrationBuilder
ÕÕ 
.
ÕÕ 
	DropTable
ÕÕ &
(
ÕÕ& '
name
ŒŒ 
:
ŒŒ 
$str
ŒŒ (
)
ŒŒ( )
;
ŒŒ) *
migrationBuilder
–– 
.
–– 
	DropTable
–– &
(
––& '
name
—— 
:
—— 
$str
—— (
)
——( )
;
——) *
migrationBuilder
”” 
.
”” 
	DropTable
”” &
(
””& '
name
‘‘ 
:
‘‘ 
$str
‘‘ '
)
‘‘' (
;
‘‘( )
migrationBuilder
÷÷ 
.
÷÷ 
	DropTable
÷÷ &
(
÷÷& '
name
◊◊ 
:
◊◊ 
$str
◊◊ (
)
◊◊( )
;
◊◊) *
migrationBuilder
ŸŸ 
.
ŸŸ 
	DropTable
ŸŸ &
(
ŸŸ& '
name
⁄⁄ 
:
⁄⁄ 
$str
⁄⁄ #
)
⁄⁄# $
;
⁄⁄$ %
migrationBuilder
‹‹ 
.
‹‹ 
	DropTable
‹‹ &
(
‹‹& '
name
›› 
:
›› 
$str
›› #
)
››# $
;
››$ %
}
ﬁﬁ 	
}
ﬂﬂ 
}‡‡ ˙
NC:\Users\dalex\OneDrive\Documentos\Code\GestionHospital\CapaDatos\MedicoDAL.cs
	namespace 	
	CapaDatos
 
{ 
public 

class 
	MedicoDAL 
{ 
private		 
readonly		  
ApplicationDbContext		 -
_context		. 6
;		6 7
public 
	MedicoDAL 
(  
ApplicationDbContext -
context. 5
)5 6
{ 	
_context 
= 
context 
; 
} 	
public 
List 
< 
	MedicoCLS 
> 
ListarMedico +
(+ ,
), -
{ 	
return 
_context 
. 
MEDICOS #
.# $

FromSqlRaw$ .
(. /
$str/ F
)F G
.G H
ToListH N
(N O
)O P
;P Q
} 	
public 
void 
GuardarMedico !
(! "
	MedicoCLS" +
medico, 2
)2 3
{ 	
var 
idParam 
= 
new 
SqlParameter *
(* +
$str+ 6
,6 7
medico8 >
.> ?
idMedico? G
)G H
;H I
var 
nombreParam 
= 
new !
SqlParameter" .
(. /
$str/ 8
,8 9
medico: @
.@ A
nombreA G
)G H
;H I
var 
apellidoParam 
= 
new  #
SqlParameter$ 0
(0 1
$str1 <
,< =
medico> D
.D E
apellidoE M
)M N
;N O
var 
telefonoParam 
= 
new  #
SqlParameter$ 0
(0 1
$str1 <
,< =
medico> D
.D E
telefonoE M
)M N
;N O
var 

emailParam 
= 
new  
SqlParameter! -
(- .
$str. 6
,6 7
medico8 >
.> ?
email? D
)D E
;E F
_context 
. 
Database 
. 
ExecuteSqlRaw +
(+ ,
$str, t
,t u
idParam 
, 
nombreParam $
,$ %
apellidoParam& 3
,3 4
telefonoParam5 B
,B C

emailParamD N
)N O
;O P
} 	
public 
	MedicoCLS 
? 
RecuperarMedico )
() *
int* -
idMedico. 6
)6 7
{   	
return!! 
_context!! 
.!! 
MEDICOS!! #
."" 

FromSqlRaw"" 
("" 
$str"" ?
,""? @
new""A D
SqlParameter""E Q
(""Q R
$str""R ]
,""] ^
idMedico""_ g
)""g h
)""h i
.## 
AsEnumerable## 
(## 
)## 
.$$ 
FirstOrDefault$$ 
($$  
)$$  !
;$$! "
}%% 	
public'' 
void'' 
EliminarMedico'' "
(''" #
int''# &
idMedico''' /
)''/ 0
{(( 	
_context)) 
.)) 
Database)) 
.)) 
ExecuteSqlRaw)) +
())+ ,
$str)), N
,))N O
new))P S
SqlParameter))T `
())` a
$str))a l
,))l m
idMedico))n v
)))v w
)))w x
;))x y
}** 	
}++ 
},, ¢#
SC:\Users\dalex\OneDrive\Documentos\Code\GestionHospital\CapaDatos\FacturacionDAL.cs
	namespace 	
	CapaDatos
 
{ 
public 

class 
FacturacionDAL 
{ 
private		 
readonly		  
ApplicationDbContext		 -
_context		. 6
;		6 7
public 
FacturacionDAL 
(  
ApplicationDbContext 2
context3 :
): ;
{ 	
_context 
= 
context 
; 
} 	
public 
List 
< 
FacturacionViewCLS &
>& '
ListarFacturacion( 9
(9 :
): ;
{ 	
return 
_context 
. !
FacturacionResultados 1
.1 2
ToList2 8
(8 9
)9 :
;: ;
} 	
public 
List 
< 
FacturacionCLS "
>" #%
ListarFacturacionPaciente$ =
(= >
int> A

idPacienteB L
)L M
{ 	
return 
_context 
. 
FACTURACION '
.' (
Where( -
(- .
c. /
=>0 2
c3 4
.4 5

idPaciente5 ?
==@ B

idPacienteC M
)M N
.N O
ToListO U
(U V
)V W
;W X
} 	
public 
void 
GuardarFacturacion &
(& '
FacturacionCLS' 5
facturacion6 A
)A B
{ 	
var 
idFacturacionParam "
=# $
new% (
SqlParameter) 5
(5 6
$str6 F
,F G
facturacionH S
.S T
idFacturacionT a
)a b
;b c
var 
idPacienteParam 
=  !
new" %
SqlParameter& 2
(2 3
$str3 @
,@ A
facturacionB M
.M N

idPacienteN X
)X Y
;Y Z
var 

montoParam 
= 
new  
SqlParameter! -
(- .
$str. 6
,6 7
facturacion8 C
.C D
montoD I
)I J
;J K
var 
metodoPagoParam 
=  !
new" %
SqlParameter& 2
(2 3
$str3 @
,@ A
facturacionB M
.M N

metodoPagoN X
)X Y
;Y Z
var   
fechaPagoParam   
=    
new  ! $
SqlParameter  % 1
(  1 2
$str  2 >
,  > ?
facturacion  @ K
.  K L
	fechaPago  L U
)  U V
;  V W
_context"" 
."" 
Database"" 
."" 
ExecuteSqlRaw"" +
(""+ ,
$str	"", Ö
,
""Ö Ü
idFacturacionParam## "
,##" #
idPacienteParam##$ 3
,##3 4

montoParam##5 ?
,##? @
metodoPagoParam##A P
,##P Q
fechaPagoParam##R `
)##` a
;##a b
}$$ 	
public&& 
FacturacionCLS&& 
?&&  
RecuperarFacturacion&& 3
(&&3 4
int&&4 7
idFacturacion&&8 E
)&&E F
{'' 	
return(( 
_context(( 
.(( 
FACTURACION(( '
.)) 

FromSqlRaw)) 
()) 
$str)) I
,))I J
new))K N
SqlParameter))O [
())[ \
$str))\ l
,))l m
idFacturacion))n {
))){ |
)))| }
.** 
AsEnumerable** 
(** 
)** 
.++ 
FirstOrDefault++ 
(++  
)++  !
;++! "
},, 	
public.. 
void.. 
EliminarFacturacion.. '
(..' (
int..( +
idFacturacion.., 9
)..9 :
{// 	
_context00 
.00 
Database00 
.00 
ExecuteSqlRaw00 +
(00+ ,
$str00, X
,00X Y
new00Z ]
SqlParameter00^ j
(00j k
$str00k {
,00{ |
idFacturacion	00} ä
)
00ä ã
)
00ã å
;
00å ç
}11 	
}22 
}33 Ï)
LC:\Users\dalex\OneDrive\Documentos\Code\GestionHospital\CapaDatos\CitaDAL.cs
	namespace 	
	CapaDatos
 
{ 
public 

class 
CitaDAL 
{ 
private		 
readonly		  
ApplicationDbContext		 -
_context		. 6
;		6 7
public 
CitaDAL 
(  
ApplicationDbContext +
context, 3
)3 4
{ 	
_context 
= 
context 
; 
} 	
public 
List 
< 
CitaViewCLS 
>  

ListarCita! +
(+ ,
), -
{ 	
return 
_context 
. 
CitasResultado *
.* +
ToList+ 1
(1 2
)2 3
;3 4
} 	
public 
List 
< 
CitaViewCLS 
>  
ListarCitasMedico! 2
(2 3
int3 6
idMedico7 ?
)? @
{ 	
var 
citas 
= 
_context  
.  !
CitasResultado! /
.  !
Where! &
(& '
c' (
=>) +
c, -
.- .
idMedico. 6
==7 9
idMedico: B
)B C
.  !
OrderBy! (
(( )
c) *
=>+ -
c. /
./ 0
	fechaHora0 9
)9 :
.  !
ToList! '
(' (
)( )
;) *
return 
citas 
; 
} 	
public   
List   
<   
CitaViewCLS   
>    
ListarCitasPaciente  ! 4
(  4 5
int  5 8

idPaciente  9 C
)  C D
{!! 	
var## 
citas## 
=## 
_context##  
.##  !
CitasResultado##! /
.$$  !
Where$$! &
($$& '
c$$' (
=>$$) +
c$$, -
.$$- .

idPaciente$$. 8
==$$9 ;

idPaciente$$< F
)$$F G
.%%  !
OrderBy%%! (
(%%( )
c%%) *
=>%%+ -
c%%. /
.%%/ 0
	fechaHora%%0 9
)%%9 :
.&&  !
ToList&&! '
(&&' (
)&&( )
;&&) *
return'' 
citas'' 
;'' 
}(( 	
public++ 
void++ 
GuardarCita++ 
(++  
CitaCLS++  '
cita++( ,
)++, -
{,, 	
var-- 
idParam-- 
=-- 
new-- 
SqlParameter-- *
(--* +
$str--+ 4
,--4 5
cita--6 :
.--: ;
idCita--; A
)--A B
;--B C
var.. 
idPacienteParam.. 
=..  !
new.." %
SqlParameter..& 2
(..2 3
$str..3 @
,..@ A
cita..B F
...F G

idPaciente..G Q
)..Q R
;..R S
var// 
idMedicoParam// 
=// 
new//  #
SqlParameter//$ 0
(//0 1
$str//1 <
,//< =
cita//> B
.//B C
idMedico//C K
)//K L
;//L M
var00 
fechaCitaParam00 
=00  
new00! $
SqlParameter00% 1
(001 2
$str002 >
,00> ?
cita00@ D
.00D E
	fechaHora00E N
)00N O
;00O P
var11 
estadoParam11 
=11 
new11 !
SqlParameter11" .
(11. /
$str11/ 8
,118 9
cita11: >
.11> ?
estado11? E
)11E F
;11F G
_context22 
.22 
Database22 
.22 
ExecuteSqlRaw22 +
(22+ ,
$str22, v
,22v w
idParam33 
,33 
idPacienteParam33 (
,33( )
idMedicoParam33* 7
,337 8
fechaCitaParam339 G
,33G H
estadoParam33I T
)33T U
;33U V
}55 	
public77 
CitaCLS77 
?77 
RecuperarCita77 %
(77% &
int77& )
idCita77* 0
)770 1
{88 	
return99 
_context99 
.99 
CITAS99 !
.:: 

FromSqlRaw:: 
(:: 
$str:: ;
,::; <
new::= @
SqlParameter::A M
(::M N
$str::N W
,::W X
idCita::Y _
)::_ `
)::` a
.;; 
AsEnumerable;; 
(;; 
);; 
.<< 
FirstOrDefault<< 
(<<  
)<<  !
;<<! "
}== 	
public?? 
void?? 
EliminarCita??  
(??  !
int??! $
idCita??% +
)??+ ,
{@@ 	
_contextAA 
.AA 
DatabaseAA 
.AA 
ExecuteSqlRawAA +
(AA+ ,
$strAA, J
,AAJ K
newAAL O
SqlParameterAAP \
(AA\ ]
$strAA] f
,AAf g
idCitaAAh n
)AAn o
)AAo p
;AAp q
}BB 	
}DD 
}EE ¸ 
YC:\Users\dalex\OneDrive\Documentos\Code\GestionHospital\CapaDatos\ApplicationDbContext.cs
	namespace 	
	CapaDatos
 
{ 
public 

class  
ApplicationDbContext %
:& '
IdentityDbContext( 9
<9 :
IdentityUser: F
>F G
{		 
public

  
ApplicationDbContext

 #
(

# $
DbContextOptions

$ 4
<

4 5 
ApplicationDbContext

5 I
>

I J
options

K R
)

R S
:

T U
base

V Z
(

Z [
options

[ b
)

b c
{ 	
} 	
public 
DbSet 
< 
PacienteCLS  
>  !
	PACIENTES" +
{, -
get. 1
;1 2
set3 6
;6 7
}8 9
public 
DbSet 
< 
	MedicoCLS 
> 
MEDICOS  '
{( )
get* -
;- .
set/ 2
;2 3
}4 5
public 
DbSet 
< 
CitaCLS 
> 
CITAS #
{$ %
get& )
;) *
set+ .
;. /
}0 1
public 
DbSet 
< 
CitaViewCLS  
>  !
CitasResultado" 0
{1 2
get3 6
;6 7
set8 ;
;; <
}= >
public 
DbSet 
< 
TratamientoCLS #
># $
TRATAMIENTOS% 1
{2 3
get4 7
;7 8
set9 <
;< =
}> ?
public 
DbSet 
< 
TratamientoViewCLS '
>' (!
TratamientosResultado) >
{? @
getA D
;D E
setF I
;I J
}K L
public 
DbSet 
< $
TratamientoMedicoViewCLS -
>- .
TratamientosMedico/ A
{B C
getD G
;G H
setI L
;L M
}N O
public 
DbSet 
< 
FacturacionCLS #
># $
FACTURACION% 0
{1 2
get3 6
;6 7
set8 ;
;; <
}= >
public 
DbSet 
< 
FacturacionViewCLS '
>' (!
FacturacionResultados) >
{? @
getA D
;D E
setF I
;I J
}K L
	protected 
override 
void 
OnModelCreating  /
(/ 0
ModelBuilder0 <
builder= D
)D E
{ 	
base 
. 
OnModelCreating  
(  !
builder! (
)( )
;) *
builder 
. 
Entity 
< 
CitaViewCLS &
>& '
(' (
)( )
.) *
HasNoKey* 2
(2 3
)3 4
.4 5
ToView5 ;
(; <
$str< L
)L M
;M N
builder 
. 
Entity 
< 
TratamientoViewCLS -
>- .
(. /
)/ 0
.0 1
HasNoKey1 9
(9 :
): ;
.; <
ToView< B
(B C
$strC Z
)Z [
;[ \
builder   
.   
Entity   
<   $
TratamientoMedicoViewCLS   3
>  3 4
(  4 5
)  5 6
.  6 7
HasNoKey  7 ?
(  ? @
)  @ A
.  A B
ToView  B H
(  H I
$str  I ]
)  ] ^
;  ^ _
builder!! 
.!! 
Entity!! 
<!! 
FacturacionViewCLS!! -
>!!- .
(!!. /
)!!/ 0
.!!0 1
HasNoKey!!1 9
(!!9 :
)!!: ;
.!!; <
ToView!!< B
(!!B C
$str!!C Z
)!!Z [
;!![ \
}## 	
}%% 
}&& 